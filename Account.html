<script>
var packages = [
	{name : 'standard-limited-company-accounting', state: [true, false, false, true, false, false]},
	{name : 'advanced-limited-company-accounting', state: [true, false, false, true, false, false]},
	{name : 'premium-limited-company-accounting', state: [true, false, false, true, false, false]},

	{name : 'standard-sole-trader-accounting', state: [false, true, false, true, false, false]},
	{name : 'advanced-sole-trader-accounting', state: [false, true, false, true, false, false]},
	{name : 'premium-sole-trader-accounting', state: [false, true, false, true, false, false]},

	{name : 'standard-virtual-office', state: [false, false, true, false, false, true]},
	{name : 'advanced-virtual-office', state: [false, false, true, false, false, true]},
	{name : 'premium-virtual-office', state: [false, false, true, false, false, true]},

	{name : 'standard-company-formation', state: [false, false, true, false, false, false]},
	{name : 'advanced-company-formation', state: [false, false, true, false, false, false]},
	{name : 'live-receptionist', state: [false, false, false, false, true, false]},
]
var  fileds = [
	'd_company1',
	'd_company2',
	'd_company3',
	'd_accounting',
	'd_receptionist',
	'd_office'
]
var state_show = [ false, false, false, false, false, false]

Webflow.push(function() {
	// Disable submitting form fields during development
	$.urlParam = function (name) {
		var results = new RegExp('[\?&]' + name + '=([^&#]*)')
		.exec(window.location.search);
		return (results !== null) ? results[1] || 0 : false;
	}
	const email = decodeURIComponent($.urlParam('email'));
	console.log(email);
	var customer_params = {
		"url": "https://cors-anywhere.herokuapp.com/https://goforma-test.chargebee.com/api/v2/customers?email[is]="+ email,
		"method": "GET",
		"headers": {
		"Content-Type": "application/x-www-form-urlencoded",
		"Authorization": "Basic dGVzdF9XOWF4ZUoxNjVTckQ5THhaWnFHU3BSS2hIeG1HMjBxWDo=",
		}
	}
	$.ajax(customer_params).done(function (res_customer) {
		console.log(res_customer);
		if(res_customer.list.length == 0)
			console.log("No User Regisered");
		else
		{
			console.log("Customer_ID", res_customer.list[0].customer.id);
			const customer_id= res_customer.list[0].customer.id;
			var subscription_params = {
				"url": "https://cors-anywhere.herokuapp.com/https://goforma-test.chargebee.com/api/v2/subscriptions?customer_id[is]="+ customer_id,
				"method": "GET",
				"headers": {
				"Content-Type": "application/x-www-form-urlencoded",
				"Authorization": "Basic dGVzdF9XOWF4ZUoxNjVTckQ5THhaWnFHU3BSS2hIeG1HMjBxWDo=",
				}
			}
			$.ajax(subscription_params).done(function (res_subscription) {
				console.log(res_subscription);
				for(var i = 0; i < res_subscription.length; i ++)
				{
					var subscription = res_subscription[i].subscription.plan_id;
					var package = packages.filter(function(pack){return pack.name == subscription});
					for(var j = 0 ; j < pacakge.state.length; j ++)
						if(package.state[j])
							state_show[j] = true;
				}
				console.log(state_show);

			})
		}
	});
});
</script>